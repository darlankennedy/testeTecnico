<VirtualHost *:80>
    Options -Indexes
    Protocols http/1.1

    SetEnvIf Authorization "(.*)" HTTP_AUTHORIZATION=$1
    RequestHeader set Authorization "expr=%{HTTP:Authorization}"

    <FilesMatch "\.php$">
        SetHandler "proxy:fcgi://app-php:9000"
    </FilesMatch>

    DocumentRoot /backend/public
    <Directory /backend/public>
        AllowOverride None
        Require all granted
        <IfModule mod_rewrite.c>
            Options -MultiViews
            RewriteEngine On
            RewriteCond %{REQUEST_FILENAME} -f
            RewriteRule .? - [L]
            RewriteRule .? /index.php [L]
        </IfModule>
    </Directory>

    <Files ~ "\.(inc|ini)$">
        Require all denied
    </Files>
    <Files .htaccess>
        Require all denied
    </Files>
</VirtualHost>
